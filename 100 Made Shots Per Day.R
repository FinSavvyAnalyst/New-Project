library(tidyverse)  
library(lubridate)
library(ggplot2)

# Load the training dates
training_dates <- c("07-09-25", "07-10-25", "07-11-25", "07-12-25", "07-14-25", "07-15-25", "07-16-25", "07-17-25", "07-18-25", "07-19-25", "07-20-25", "07-21-25", "07-23-25", "07-24-25", "07-26-25", "07-28-25", "07-29-25",  "07-30-25", "07-31-25", "08-01-25", "08-02-25", "08-04-25", "08-05-25", "08-06-25", "08-07-25", "08-08-25", "08-10-25", "08-11-25", "08-12-25", "08-13-25", "08-14-25", "08-15-25", "08-16-25", "08-18-25", "08-19-25", "08-21-25", "08-23-25", "08-25-25", "08-27-25", "08-28-25", "08-29-25", "09-01-25", "09-02-25", "09-03-25", "09-04-25", "09-05-25", "09-06-25", "09-07-25", "09-08-25", "09-09-25", "09-10-25", "09-12-25", "09-16-25", "09-17-25", "09-23-25", "09-24-25", "09-25-25", "09-26-25", "09-28-25", "10-01-25", "10-02-25", "10-03-25", "10-06-25", "10-07-25", "10-09-25", "10-13-25", "10-14-25", "10-15-25", "10-20-25", "10-21-25", "10-24-25", "10-27-25", "10-28-25", "10-29-25", "11-03-25", "11-04-25", "11-05-25")

training_dates <- sub("(\\d{2})$", "20\\1", training_dates)           # Format the data properly
training_dates <- as.Date(training_dates, format = "%m-%d-20%y")      # Convert to date format

# Load the training times
training_times <- c("22:11:46", "19:56:56", "22:46:00", "24:36:07", "22:26:21", "20:56:23", "19:15:47", "26:49:55", "21:35:50", "26:34:29", "19:19:96", "20:39:50", "22:33:36", "25:46:62", "23:45:88", "19:51:27", "25:52:91", "25:09:53", "18:55:61", "22:31:03", "22:49:79", "24:43:27", "21:00:34", "19:20:91", "18:20:33", "17:21:44", "19:32:72", "21:34:78", "18:52:33", "17:28:22", "20:17:24", "22:09:41", "21:57:15", "20:10:43", "16:46:90", "19:08:71", "21:44:79", "16:15:79", "20:31:26", "15:07:93", "15:56:35", "19:39:93", "18:10:45", "19:26:58", "19:17:79", "18:02:15", "18:57:38", "16:08:06", "17:38:94", "18:34:95", "23:03:45", "18:05:88", "16:53:36", "15:16:35", "17:38:93", "18:07:38", "18:57:96", "15:36:54", "22:00:34", "17:08:30", "15:57:45", "16:18:22", "18:18:96", "16:33:93", "16:42:93", "17:01:62", "15:40:14", "18:53:88", "18:44:43", "16:27:53", "15:16:81", "15:23:28", "21:30:18", "16:37:18", "17:46:11", "21:18:88", "16:02:16")

training_time.sec <- function(training_times) {                       # Create a time conversion function
  parts <- strsplit(training_times, ":")
  total_seconds <- sapply(parts, function(x) {
    minutes <- as.numeric(x[1])
    seconds <- as.numeric(x[2])
    hundredths <- as.numeric(x[3])
    (minutes * 60) + (seconds) + (hundredths / 100)})
  return(total_seconds)}

training_sec <- training_time.sec(training_times)                     # Convert stopwatch time to seconds
training_min <- training_sec / 60                                     # Convert seconds to minutes

training_min.df <- data.frame(                                        # Create the data frame
  Date = training_dates,
  Time = training_min)

# Plot the data
ggplot(training_min.df,
       aes(x = Date, y = Time)) +
  labs(title = "Summer Workout: 100 Made Shots", ylab = "Minutes") +
  geom_line(color = "steelblue") +
  geom_smooth(method = "lm", color = "red", linetype = "dashed", linewidth = 0.8)
